;=======================================================================
;描述符类型值说明。
;其中：
;	DA_: 	Descriptor Attribute
;	D:	数据段
;	C:	代码段
;	S:	系统段
;	R:	只读
;	RW:	读写
;	A:	已访问
;    其他:	可按照字面意思理解
;G D 0 AVL 0 0 0 0 P DPL
;=======================================================================
DA_32		equ	4000h			;32位段
DA_LIMIT_4K	equ	8000h			;段界限粒度为4k

DA_DPL0		equ	00h			; DPL=0
DA_DPL1		equ	20h
DA_DPL2		equ	40h
DA_DPL3		equ	60h
;=======================================================================
;存储段描述符类型值说明。
DA_DR		equ	90h			;存在的只读数据段类型值
DA_DRW		equ	92h			;存在的可读写数据段属性值
DA_DRWA		equ	93h			;存在的已访问可读写数据段类型值
DA_C		equ	98h			;存在的只执行代码段属性值
DA_CR		equ	9ah			;存在的可执行可读代码段
DA_CCO		equ	9ch			;存在的只执行一致代码段
DA_CCR		equ	9eh			;存在的可执行可读一致代码段
;=======================================================================
;系统段描述符类型说明



;=======================================================================
;选择子
;RPL:				请求特权级，用于特权检查。
;TI(Tabel Indicator):		引用描述符表指示位
;		TI=0		指示从GDT中读取描述符
;		TI=1		从LDT中都去描述符
;=======================================================================
;选择子类型说明
;其中：
;	SA_ : Selector Attribute

SA_RPL0		equ	0
SA_RPL1		equ	1
SA_RPL2		equ	2
SA_RPL3		equ	3

SA_TIG		equ	0
SA_TIL		equ	4

;=======================================================================
;分页机制使用的常量说明
;=======================================================================
PG_P		equ	1			;页存在属性
PG_RWR		equ	0			;R/W 读/执行
PG_RWW		equ	2			;R/W 读/写/执行
PG_USS		equ	0			;U/S 系统级
PG_USU		equ	4			;U/S 用户级
;=======================================================================
;=======================================================================
;描述符宏。
;用法：		Descriptor Base, Limit, Attr
;		Base:	 dd
;		Limit:	 dd (低20位有效)
;		Attr:	 dw (高字节的低4位总是0)

%macro Descriptor 3				;接受3个实元。
	dw %2 & 0ffffh				;段界限1
	dw %1 & 0ffffh				;段基址1
	db (%1 >> 16) & 0ffh			;段基址2
	dw ((%2 >> 8) & 0f00h) | (%3 & 0f0ffh)	;属性1 + 段界限2 + 属性2
	db (%1 >> 24) & 0ffh			;段基址3
%endmacro					;宏一共8字节。

